#add sudoer
sudo usermod -aG sudo tringuyen
sudo nano /etc/sudoers
tringuyen  ALL=(ALL) NOPASSWD:ALL

#list partition
sudo lsblk -o NAME,FSTYPE,SIZE,MOUNTPOINT

#Disable swap
swapoff -a                 # Disable all devices marked as swap in /etc/fstab
sed -e '/swap/ s/^#*/#/' -i /etc/fstab   # Comment the correct mounting point
systemctl mask swap.target               # Completely disabled

#echo and tee command
echo "<?php phpinfo(); ?>" | sudo tee /var/www/test.php > /dev/null && sudo chgrp www-data /var/www/test.php

#PREVENT CHANGES FOR A PACKAGE
       hold
           hold is used to mark a package as held back, which will prevent the package from being
           automatically installed, upgraded or removed
apt-mark hold kubelet kubeadm kubectl


## Add some settings to sysctl
sudo tee /etc/sysctl.d/kubernetes.conf<<EOF
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
net.ipv4.ip_forward = 1
EOF

#Get current user
sudo echo $USER


#Special, User/Owner, Group, and Others in that order, when working with the four-number chmods, with that first number being special bits that can be set.

chmod 4555 equates to the following:

Set UID bit - Run the file as the owner regardless of which user is running it
User/Owner: Read, Execute
Group: Read, Execute
Others: Read, Execute


# Create auto-swap script
mkdir /opt/scripts
cat <<'EOT' >> /opt/scripts/swap.sh
#!/bin/bash
exec 3>&1 4>&2
trap 'exec 2>&4 1>&3' 0 1 2 3
exec 1>/opt/scripts/swap.log 2>&1
# Create SWAP partition
sudo mkswap $(lsblk | grep  "279.4G" | cut -d " " -f1 | perl -ne 'print "/dev/$_"')
sudo swapon $(lsblk | grep  "279.4G" | cut -d " " -f1 | perl -ne 'print "/dev/$_"')
swapon -s
EOT

#add user home directory
sudo useradd -D --base-dir /home/tringuyen

#add user to ssh
nano /etc/ssh/sshd_config
...
PasswordAuthen.....
AllowUsers tringuyen


#ec2
Add a new user to the EC2 Linux instance
1.    Connect to your Linux instance using SSH.
2.    Use the adduser command to add a new user account to an EC2 instance (replace new_user with the new account name). The following example creates an associated group, home directory, and an entry in the /etc/passwd file of the instance.
sudo adduser new_user

The home directory might not be created by default in some configurations. Verify that the home directory was created before continuing.
Note: If you add the new_user to an Ubuntu instance, then include the --disabled-password option to avoid adding a password to the new account:
sudo adduser new_user --disabled-password

3.    Change the security context to the new_user account so that folders and files you create have the correct permissions:
sudo su - new_user
Note: When you run the sudo su - new_user command, the name at the top of the command shell prompt changes to reflect the new user account context of your shell session.

4.    Create a .ssh directory in the new_user home directory:
mkdir .ssh

5.    Use the chmod command to change the .ssh directory's permissions to 700. Changing the permissions restricts access so that only the new_user can read, write, or open the .ssh directory.
chmod 700 .ssh

6.    Use the touch command to create the authorized_keys file in the .ssh directory:
touch .ssh/authorized_keys

7.    Use the chmod command to change the .ssh/authorized_keys file permissions to 600. Changing the file permissions restricts read or write access to the new_user.
chmod 600 .ssh/authorized_keys


#Remove a user
If a user is no longer needed, you can remove that user so that it can no longer be used.
Use the userdel command to remove the user from the system. When you specify the -r parameter, the user's home directory and mail spool are deleted. To keep the user's home directory and mail spool, omit the -r parameter.
sudo userdel -r olduser


#Note
echo hello >/dev/null 2>&1 có ý nghĩa là
>/dev/null: redirect tất cả các standard output sang /dev/null . Tương đương cách viết 1>/dev/null
2>&1: redirect tất cả các standard error sang standard output. Nhưng thời điểm này standard output đang trỏ tới /dev/null nên standard error sẽ redirect tới /dev/null